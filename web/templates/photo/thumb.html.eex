<%
  photo_album = assigns[:photo_album] || @photo.photo_album
  user        = assigns[:user] || photo_album.user
  hide_title  = assigns[:hide_title] || false
%>
<div class="card photo" data-id="<%= @photo.id %>">
  <%= link to: public_profile_photo_album_photo_path(@conn, :show, user, photo_album, @photo) do %>
    <%= if @photo.nsfw do %>
      <%= img_tag(static_path(@conn, "/images/photo_thumb_nsfw.jpg"), class: "card-img-top img-fluid img-photo") %>
    <% else %>
      <%= img_tag(Helheim.PhotoFile.url({@photo.file, @photo}, :thumb), class: "card-img-top img-fluid img-photo") %>
    <% end %>
  <% end %>
  <div class="card-block">
    <div class="d-flex w-100 justify-content-between">
      <div>
        <small>
          <%= username user %>
        </small>
      </div>
      <div>
        <%= visitor_count_badge @conn, @photo %>
        <%= comment_count_badge @photo %>
      </div>
    </div>
    <%= unless hide_title do %>
      <p class="card-text">
        <strong class="text-break-up"><%= @photo.title %></strong><br>
        <small><%= time_ago_in_words @photo.inserted_at %></small>
      </p>
    <% end %>
    <%= visibility_badge photo_album %>
  </div>
</div>
